<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEO PISK - COMPRA</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
</head>
<body style="background:#1a1a1a; color:white; text-align:center; font-family:sans-serif; padding:20px;">
    <div style="max-width:400px; margin:auto; border:2px solid #ff8c00; border-radius:15px; padding:20px;">
        <h1>NEO PISK üî•</h1>
        <p>Precio: 1 USDT = 100 $PISK</p>
        <input type="number" id="amount" value="1" style="width:80%; padding:10px; margin:10px; border-radius:5px;">
        <button onclick="comprar()" style="width:90%; padding:15px; background:#ff8c00; color:white; border:none; border-radius:10px; font-weight:bold; cursor:pointer;">COMPRAR AHORA</button>
        <div id="status" style="margin-top:15px; color:#ffca28;">Listo para conectar</div>
    </div>

<script>
    const miContrato = "0x8503C3193E94F8628043657C6C8a21B320fB0931";
    const usdtPolygon = "0xc2132D05D31c914a87C6611C10748AEb04B58e8F";

    async function comprar() {
        try {
            if (!window.ethereum) { alert("Usa el navegador de MetaMask"); return; }
            
            const provider = new ethers.providers.Web3Provider(window.ethereum);
            await provider.send("eth_requestAccounts", []);
            const signer = provider.getSigner();
            
            const amount = document.getElementById('amount').value;
            const usdtContract = new ethers.Contract(usdtPolygon, ["function transfer(address to, uint256 amount) public returns (bool)"], signer);
            
            // 6 decimales para USDT
            const amountWei = ethers.utils.parseUnits(amount, 6);
            
            document.getElementById('status').innerText = "Abriendo MetaMask...";
            
            // ENV√çO DE USDT AL CONTRATO
            const tx = await usdtContract.transfer(miContrato, amountWei);
            
            document.getElementById('status').innerText = "Procesando compra...";
            await tx.wait();
            
            document.getElementById('status').innerText = "¬°COMPRA EXITOSA!";
            alert("¬°Felicidades! Compra realizada.");
        } catch (error) {
            console.error(error);
            document.getElementById('status').innerText = "Error: Revisa tu saldo de POL y USDT";
        }
    }
</script>
</body>
</html>
