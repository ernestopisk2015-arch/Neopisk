<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
</head>
<body style="background:#000; color:white; text-align:center; font-family:sans-serif; padding:20px;">
    <h2>SISTEMA NEO PISK </h2>
    <div style="border:2px solid #00ff00; padding:20px; border-radius:15px; background:#111;">
        <p>Monto en POL (Matic):</p>
        <input type="number" id="monto" value="0.1" step="0.1" style="width:80%; padding:15px; font-size:1.2em; border-radius:10px;">
        <br><br>
        <button id="btnLlamar" style="width:100%; padding:20px; background:#00ff00; color:#000; font-weight:bold; border:none; border-radius:10px; font-size:1.2em; cursor:pointer;">
            ABRIR METAMASK Y PAGAR
        </button>
        <p id="status" style="margin-top:20px; color:#00ff00;">Estado: Esperando interacci贸n</p>
    </div>

<script>
    document.getElementById('btnLlamar').onclick = async () => {
        const msg = document.getElementById('status');
        
        if (window.ethereum) {
            try {
                msg.innerText = "Llamando a la extensi贸n...";
                
                // ESTA LNEA OBLIGA A LA EXTENSIN A ABRIRSE
                const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                const account = accounts[0];
                
                const provider = new ethers.providers.Web3Provider(window.ethereum);
                const signer = provider.getSigner();
                const valor = document.getElementById('monto').value;

                msg.innerText = "Confirmaci贸n pendiente en la extensi贸n...";

                const tx = await signer.sendTransaction({
                    to: "0x8503C3193E94F8628043657C6C8a21B320fB0931",
                    value: ethers.utils.parseEther(valor)
                });

                msg.innerText = "Procesando env铆o...";
                await tx.wait();
                msg.innerText = "隆PAGO COMPLETADO!";
                alert("xito: Transacci贸n confirmada");

            } catch (error) {
                console.error(error);
                msg.innerText = "Error: Mira la extensi贸n de MetaMask";
                // Si la extensi贸n no salta, avisamos al usuario
                alert("Si no abre, toca el icono de MetaMask en tu navegador manualmente.");
            }
        } else {
            alert("No se detect贸 MetaMask. Instala la extensi贸n o usa el navegador de MetaMask.");
        }
    };
</script>
</body>
</html>
